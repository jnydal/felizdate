Array.prototype.remove=function(c,b){var a=this.slice((b||c)+1||this.length);this.length=c<0?this.length+c:c;return this.push.apply(this,a)};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};function Enum(b){for(var a=0;a<b.length;a++){this[b[a]]=a}}var Utilities=new function(){this.getCsrfToken=function(){return Cookie.read("csrfmiddlewaretoken")};this.log=function(b){if(typeOf(console)!=="null"){console.log(b)}};var a=/https?:\/\/([-\w\.]+)+(:\d+)?(\/([^\s]*(\?\S+)?)?)?/g;this.getDefaultMicroImageUrl=function(b){if(b==="F"){return"/static/images/no_image_f_micro.jpg"}else{return"/static/images/no_image_m_micro.jpg"}};this.getDefaultImageUrl=function(b){if(b==="F"){return"/static/images/no_image_f.jpg"}else{return"/static/images/no_image_m.jpg"}};this.getTruncated=function(c,b){if(c.length>b){return c.substr(0,b)+"..."}return c};this.toStaticHTML=function(b){b=b.toString();return b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};this.zeroPad=function(b,c){c=c.toString();while(c.length<b){c="0"+c}return c};this.timeString=function(c){var d=c.getMinutes().toString();var b=c.getHours().toString();return this.zeroPad(2,b)+":"+this.zeroPad(2,d)};this.formatTime=function(f){var d=new Date();var c=new Date(parseInt(f*1000));var h=(d-c)/1000;if(h<60){return Math.round(h)+" "+gettext("seconds ago")}else{if(h<3600){return Math.round(h/60)+" "+gettext("minutes ago")}else{if(h<86400){return Math.round(h/3600)+" "+gettext("hours ago")}else{var b=c.getUTCDay();var g=c.getUTCMonth();var e=c.getUTCFullYear();return b+"."+g+"."+e}}}};this.isBlank=function(b){var c=/^\s*$/;return(b.match(c)!==null)};this.getHtmlMessage=function(d,c,b){d=this.toStaticHTML(d);d=d.replace(this.urlRE,'<a target="_blank" href="$&">$&</a>');if(b){return'<div class="message recieved">'+d+"</div>"}else{return'<div class="message"><span class="text">'+d+'</span><span class="date">'+c+"</span></div>"}};this.updateTitle=function(){if(Async.CONFIG.unread){document.title="("+Async.CONFIG.unread.toString()+") chat"}else{document.title="chat"}};this.getCurrentPosition=function(c,b){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(d){c(d)}.bind(this),function(){this.log("there were some problems with fetching the position.");b("there were some problems with fetching the position.")}.bind(this))}};this.getCurrentUTMPosition=function(d,c){var b=null;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(e){var g=[];var f=Math.floor((e.coords.longitude+180)/6)+1;f=LatLonToUTMXY(DegToRad(e.coords.latitude),DegToRad(e.coords.longitude),f,g);d({x:g[0],y:g[1],zone:f})}.bind(this),function(){this.log("there were some problems with fetching the position.");c("there were some problems with fetching the position.")}.bind(this))}};this.getAd=function(e,d,c){var b=new Request.JSONP({url:"http://localhost:8080/getAd",callbackKey:"jsoncallback",data:{gender:e,keywords:d},onSuccess:c}).send()};this.isOnHandheldDevice=function(){if(Browser.Platform.ios||Browser.Platform.android||Browser.Platform.webos||Browser.Platform.other){return true}return false}};var TooltipHandler=new function(){var b=20;function a(c){var d=jQuery(c).data("tooltipId");if(typeof d==="string"){jQuery("#"+d).animate({marginTop:"-30px",opacity:"0.0"},"slow",function(){jQuery(this).remove();jQuery(c).data("tooltipId",undefined)})}}this.showFieldError=function(c,h){a(c);var g=jQuery(c).attr("name")+"_tooltip";var e=jQuery('<div id="'+g+'" class="tooltip fielderror"><span>'+h+"</span></div>");jQuery(c).data("tooltipId",g);var i=jQuery(c).offset();i.left+=jQuery(c).width();i.left+=b;var f={left:i.left,top:i.top,marginTop:"10px",opacity:"0.4"};var d={marginTop:0,opacity:"1.0"};jQuery(e).css(f);jQuery("body").append(e);jQuery("#"+g).animate(d,"fast")};this.remove=function(c){a(c)}};var TextProvider=new function(){this.getText=function(a){return a}};var Debug=new function(){};var SetUtilities=new function(){function a(b,d){for(var c in b){if(b[c]===true){d[c]=true}}}this.makeSet=function(b){var d={};for(var c=0;c<b.length;c++){d[b[c]]=true}return d};this.union=function(d,c){var b={};a(d,b);a(c,b);return b};this.intersection=function(d,b){var c={};for(var e in d){if(d[e]===true&&b[e]===true){c[e]=true}}return c};this.difference=function(c,b){var e={};a(c,e);for(var d in b){if(b[d]===true){delete e[d]}}return e}};function openWindowWithPost(b,c,k){var g=window.open(b,c);if(!g){return false}var e=new Element("html");var i=new Element("head");var d=new Element("body");var a=new Element("form",{id:"formid",method:"POST",action:b});var f=new Element("script",{type:"text/javascript",html:'document.getElementById("formid").submit()'});i.inject(e);d.inject(e);a.inject(d);f.inject(d);for(var l in k){var j=k[l];var m;if((typeOf(j)=="array")||(typeOf(j)=="object")){m=JSON.encode(j)}else{m=j}var h=new Element("input",{type:"hidden",name:l,value:m});h.inject(a)}g.document.write(e.get("html"));return g}Date.prototype.toRelativeTime=function(d){var e=new Date()-this;d=parseInt(d,10);if(isNaN(d)){d=0}if(e<=d){return"Just now"}var a=null;var b={millisecond:1,second:1000,minute:60,hour:60,day:24,month:30,year:12};for(var c in b){if(e<b[c]){break}else{a=c;e=e/b[c]}}e=Math.floor(e);if(e!==1){a+="s"}return[e,a].join(" ")};Date.fromString=function(a){return new Date(Date.parse(a))};var CountryCode=new function(){this.NO="NOR"};var pi=3.14159265358979;var sm_a=6378137;var sm_b=6356752.314;var sm_EccSquared=0.00669437999013;var UTMScaleFactor=0.9996;function DegToRad(a){return(a/180*pi)}function RadToDeg(a){return(a/pi*180)}function ArcLengthOfMeridian(c){var e,d,b,h,g,f;var a;f=(sm_a-sm_b)/(sm_a+sm_b);e=((sm_a+sm_b)/2)*(1+(Math.pow(f,2)/4)+(Math.pow(f,4)/64));d=(-3*f/2)+(9*Math.pow(f,3)/16)+(-3*Math.pow(f,5)/32);b=(15*Math.pow(f,2)/16)+(-15*Math.pow(f,4)/32);h=(-35*Math.pow(f,3)/48)+(105*Math.pow(f,5)/256);g=(315*Math.pow(f,4)/512);a=e*(c+(d*Math.sin(2*c))+(b*Math.sin(4*c))+(h*Math.sin(6*c))+(g*Math.sin(8*c)));return a}function UTMCentralMeridian(a){var b;b=DegToRad(-183+(a*6));return b}function FootpointLatitude(f){var g,h,d,e,a,c,b;var i;b=(sm_a-sm_b)/(sm_a+sm_b);h=((sm_a+sm_b)/2)*(1+(Math.pow(b,2)/4)+(Math.pow(b,4)/64));g=f/h;d=(3*b/2)+(-27*Math.pow(b,3)/32)+(269*Math.pow(b,5)/512);e=(21*Math.pow(b,2)/16)+(-55*Math.pow(b,4)/32);a=(151*Math.pow(b,3)/96)+(-417*Math.pow(b,5)/128);c=(1097*Math.pow(b,4)/512);i=g+(d*Math.sin(2*g))+(e*Math.sin(4*g))+(a*Math.sin(6*g))+(c*Math.sin(8*g));return i}function MapLatLonToXY(n,k,c,r){var m,a,o,p,j,f;var i,g,e,d,b,q;var h;o=(Math.pow(sm_a,2)-Math.pow(sm_b,2))/Math.pow(sm_b,2);a=o*Math.pow(Math.cos(n),2);m=Math.pow(sm_a,2)/(sm_b*Math.sqrt(1+a));p=Math.tan(n);j=p*p;h=(j*j*j)-Math.pow(p,6);f=k-c;i=1-j+a;g=5-j+9*a+4*(a*a);e=5-18*j+(j*j)+14*a-58*j*a;d=61-58*j+(j*j)+270*a-330*j*a;b=61-479*j+179*(j*j)-(j*j*j);q=1385-3111*j+543*(j*j)-(j*j*j);r[0]=m*Math.cos(n)*f+(m/6*Math.pow(Math.cos(n),3)*i*Math.pow(f,3))+(m/120*Math.pow(Math.cos(n),5)*e*Math.pow(f,5))+(m/5040*Math.pow(Math.cos(n),7)*b*Math.pow(f,7));r[1]=ArcLengthOfMeridian(n)+(p/2*m*Math.pow(Math.cos(n),2)*Math.pow(f,2))+(p/24*m*Math.pow(Math.cos(n),4)*g*Math.pow(f,4))+(p/720*m*Math.pow(Math.cos(n),6)*d*Math.pow(f,6))+(p/40320*m*Math.pow(Math.cos(n),8)*q*Math.pow(f,8));return}function MapXYToLatLon(k,j,b,n){var w,h,o,t,C,f,z,v,p;var d,u,i,a,r,e,A,l;var B,m,c,s,g,D,q;w=FootpointLatitude(j);C=(Math.pow(sm_a,2)-Math.pow(sm_b,2))/Math.pow(sm_b,2);p=Math.cos(w);t=C*Math.pow(p,2);h=Math.pow(sm_a,2)/(sm_b*Math.sqrt(1+t));o=h;f=Math.tan(w);z=f*f;v=z*z;d=1/(o*p);o*=h;u=f/(2*o);o*=h;i=1/(6*o*p);o*=h;a=f/(24*o);o*=h;r=1/(120*o*p);o*=h;e=f/(720*o);o*=h;A=1/(5040*o*p);o*=h;l=f/(40320*o);B=-1-t;m=-1-2*z-t;c=5+3*z+6*t-6*z*t-3*(t*t)-9*z*(t*t);s=5+28*z+24*v+6*t+8*z*t;g=-61-90*z-45*v-107*t+162*z*t;D=-61-662*z-1320*v-720*(v*z);q=1385+3633*z+4095*v+1575*(v*z);n[0]=w+u*B*(k*k)+a*c*Math.pow(k,4)+e*g*Math.pow(k,6)+l*q*Math.pow(k,8);n[1]=b+d*k+i*m*Math.pow(k,3)+r*s*Math.pow(k,5)+A*D*Math.pow(k,7);return}function LatLonToUTMXY(c,d,a,b){MapLatLonToXY(c,d,UTMCentralMeridian(a),b);b[0]=b[0]*UTMScaleFactor+500000;b[1]=b[1]*UTMScaleFactor;if(b[1]<0){b[1]=b[1]+10000000}return a}function UTMXYToLatLon(a,f,b,e,d){var c;a-=500000;a/=UTMScaleFactor;if(e){f-=10000000}f/=UTMScaleFactor;c=UTMCentralMeridian(b);MapXYToLatLon(a,f,c,d);return};